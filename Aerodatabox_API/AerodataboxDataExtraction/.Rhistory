for (flug in linienfluege){
process <- filter(airport_raw_input, number == flug)
mean_diff <- c(mean_diff, mean(abs(process$diff)))
median_diff <- c(median_diff, median(abs(process$diff)))
quantile_75 <- c(quantile_75, quantile(abs(process$diff), probs = 0.75))
quantile_95 <- c(quantile_95, quantile(abs(process$diff), probs = 0.95))
arrival_airport <- c(arrival_airport, head(process, n = 1)$arrivalAirport)
}
# create dataframe of linienfluege, mean, median and arrival airport
flights <- data.frame(linienfluege, mean = mean_diff, median = median_diff, quantile75 = quantile_75, quantile95 = quantile_95, arrival_airport = arrival_airport)
# delete elements
rm(flug, limit, median_diff, mean_diff, linienfluege, input, process, arrival_airport, airport_raw_input, airport_group, quantile_75, quantile_95)
# Boxplot of mean
boxplot(flights$mean)
median(flights$mean)
# sort dataframe
flights <- flights[
with(flights, order(mean)),
]
relevant_airports_v <- c(unique(flights$arrival_airport), airport)
relevant_airports_df <- data.frame(relevant_airports_v)
names(relevant_airports_df) <- "airports"
airports <- left_join(relevant_airports_df, airports, by = c("airports" = "V6"))
## Calculate matrix of differences in km
distance.matrix <- distm(x = airports[,c("V8", "V7")],  y = airports[,c("V8", "V7")])/1000
## Rename dimensions to airport codes
rownames(distance.matrix) <- airports$airports
colnames(distance.matrix) <- airports$airports
relevant_distances <- as.vector(tail(distance.matrix, n = 1))
relevant_airports_distances <- data.frame(relevant_airports_v, relevant_distances)
flights <- left_join(flights, relevant_airports_distances, by = c("arrival_airport" = "relevant_airports_v"))
rm(relevant_airports_df, relevant_airports_distances, relevant_airports_v, relevant_distances, distance.matrix)
median <- flights[["median"]]
mean <- flights[["mean"]]
distance <- flights[["relevant_distances"]]
relation <- lm(mean~distance)
plot(distance, mean, main = "Regression")
abline(relation, col = "red")
cor.test(distance, mean)
############# SETUP ###############
# Libraries
library(dplyr)
library(geosphere)
library(plotrix)
# Path
setwd("/Users/tobiasleitner/Desktop/IT-Projekt/Aerodatabox_API/AerodataboxDataExtraction")
rm(list = ls())
# Variables
input <- "aerodata_flughafen_wien.csv"
limit <- 20
airport <- "LOWW"
# read data
airport_raw_input <- read.csv2(input)
airports <- read.csv("https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat", header = F)
# change timestamps to utc
airport_raw_input$scheduledTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$scheduledTime)), origin="1970-01-01", tz="UTC")
airport_raw_input$actualTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$actualTime)), origin="1970-01-01", tz="UTC")
# difference between scheduled and real departure
difftime_diff <- difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime)
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
# Group by by number, arrivalAirport and count flights
airport_group <- group_by(airport_raw_input, number, arrivalAirport)
airport_group <- summarize(airport_group, count = n())
# Fiter by flight limit set above
linienfluege <- filter(airport_group, count > limit)
linienfluege <- as.vector(linienfluege[['number']])
mean_diff <- c()
median_diff <- c()
arrival_airport <- c()
quantile_75 <- c()
quantile_95 <- c()
# Filter raw input by linienflüge - only the relevant flights are left
# Calculate mean and median of difference between scheduled and actual departure time for every
for (flug in linienfluege){
process <- filter(airport_raw_input, number == flug)
mean_diff <- c(mean_diff, mean(abs(process$diff)))
median_diff <- c(median_diff, median(abs(process$diff)))
quantile_75 <- c(quantile_75, quantile(abs(process$diff), probs = 0.75))
quantile_95 <- c(quantile_95, quantile(abs(process$diff), probs = 0.95))
arrival_airport <- c(arrival_airport, head(process, n = 1)$arrivalAirport)
}
# create dataframe of linienfluege, mean, median and arrival airport
flights <- data.frame(linienfluege, mean = mean_diff, median = median_diff, quantile75 = quantile_75, quantile95 = quantile_95, arrival_airport = arrival_airport)
# delete elements
rm(flug, limit, median_diff, mean_diff, linienfluege, input, process, arrival_airport, airport_raw_input, airport_group, quantile_75, quantile_95)
# Boxplot of mean
boxplot(flights$mean)
median(flights$mean)
# sort dataframe
flights <- flights[
with(flights, order(mean)),
]
relevant_airports_v <- c(unique(flights$arrival_airport), airport)
relevant_airports_df <- data.frame(relevant_airports_v)
names(relevant_airports_df) <- "airports"
airports <- left_join(relevant_airports_df, airports, by = c("airports" = "V6"))
## Calculate matrix of differences in km
distance.matrix <- distm(x = airports[,c("V8", "V7")],  y = airports[,c("V8", "V7")])/1000
## Rename dimensions to airport codes
rownames(distance.matrix) <- airports$airports
colnames(distance.matrix) <- airports$airports
relevant_distances <- as.vector(tail(distance.matrix, n = 1))
relevant_airports_distances <- data.frame(relevant_airports_v, relevant_distances)
flights <- left_join(flights, relevant_airports_distances, by = c("arrival_airport" = "relevant_airports_v"))
rm(relevant_airports_df, relevant_airports_distances, relevant_airports_v, relevant_distances, distance.matrix)
median <- flights[["median"]]
mean <- flights[["mean"]]
distance <- flights[["relevant_distances"]]
relation <- lm(mean~distance)
plot(distance, mean, main = "Regression")
abline(relation, col = "red")
cor.test(distance, mean)
newflights <- filter(flights, median > 5)
median <- newflights[["median"]]
mean <- newflights[["mean"]]
distance <- newflights[["relevant_distances"]]
relation <- lm(median~distance)
plot(distance, median)
abline(relation, col = "red")
cor.test(distance, median)
kurz <- filter(flights, relevant_distances < 1500)
lang <- filter(flights, relevant_distances > 1500)
m <- median(flights$mean)
kurz_late <- filter(kurz, mean > m)
kurz_ok <- filter(kurz, mean< m)
lang_late <- filter(lang, mean > m)
lang_ok <- filter(lang, mean < m)
anteil_kurz_late <- count(kurz_late)/count(kurz)
anteil_lang_late <- count(lang_late)/count(lang)
anteil_kurz_ok <- count(kurz_ok)/count(kurz)
anteil_lang_ok <- count(lang_ok)/count(lang)
a <- anteil_kurz_late[1,1]
b <- anteil_kurz_ok[1,1]
c <- anteil_lang_late[1,1]
d <- anteil_lang_ok[1,1]
slices <- c(a,b)
lbls <- c("Verspätet", "Pünktlich")
pie3D(slices, labels = lbls, main="Kurzstreckenflüge - Verspätet / Pünktlich", explode = 0.1)
slices <- c(a,b)
lbls <- c("Verspätet", "Pünktlich")
pie(slices, labels = lbls, main="Kurzstreckenflüge - Verspätet / Pünktlich")
slices <- c(a,b)
lbls <- c("Verspätet", "Pünktlich")
pie(slices, labels = lbls, main="Kurzstreckenflüge")
slices <- c(c,d)
lbls <- c("Verspätet", "Pünktlich")
pie(slices, labels = lbls, main="Langstreckenflüge")
############# SETUP ###############
# Libraries
library(dplyr)
library(geosphere)
library(plotrix)
# Path
setwd("/Users/tobiasleitner/Desktop/IT-Projekt/Aerodatabox_API/AerodataboxDataExtraction")
rm(list = ls())
# Variables
input <- "aerodata_flughafen_amsterdam.csv"
limit <- 20
airport <- "EHAM"
# read data
airport_raw_input <- read.csv2(input)
airports <- read.csv("https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat", header = F)
# change timestamps to utc
airport_raw_input$scheduledTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$scheduledTime)), origin="1970-01-01", tz="UTC")
airport_raw_input$actualTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$actualTime)), origin="1970-01-01", tz="UTC")
# difference between scheduled and real departure
difftime_diff <- difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime)
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
# Group by by number, arrivalAirport and count flights
airport_group <- group_by(airport_raw_input, number, arrivalAirport)
airport_group <- summarize(airport_group, count = n())
# Fiter by flight limit set above
linienfluege <- filter(airport_group, count > limit)
linienfluege <- as.vector(linienfluege[['number']])
mean_diff <- c()
median_diff <- c()
arrival_airport <- c()
quantile_75 <- c()
quantile_95 <- c()
# Filter raw input by linienflüge - only the relevant flights are left
# Calculate mean and median of difference between scheduled and actual departure time for every
for (flug in linienfluege){
process <- filter(airport_raw_input, number == flug)
mean_diff <- c(mean_diff, mean(abs(process$diff)))
median_diff <- c(median_diff, median(abs(process$diff)))
quantile_75 <- c(quantile_75, quantile(abs(process$diff), probs = 0.75))
quantile_95 <- c(quantile_95, quantile(abs(process$diff), probs = 0.95))
arrival_airport <- c(arrival_airport, head(process, n = 1)$arrivalAirport)
}
# create dataframe of linienfluege, mean, median and arrival airport
flights <- data.frame(linienfluege, mean = mean_diff, median = median_diff, quantile75 = quantile_75, quantile95 = quantile_95, arrival_airport = arrival_airport)
# delete elements
rm(flug, limit, median_diff, mean_diff, linienfluege, input, process, arrival_airport, airport_raw_input, airport_group, quantile_75, quantile_95)
# Boxplot of mean
boxplot(flights$mean)
median(flights$mean)
# sort dataframe
flights <- flights[
with(flights, order(mean)),
]
relevant_airports_v <- c(unique(flights$arrival_airport), airport)
relevant_airports_df <- data.frame(relevant_airports_v)
names(relevant_airports_df) <- "airports"
airports <- left_join(relevant_airports_df, airports, by = c("airports" = "V6"))
## Calculate matrix of differences in km
distance.matrix <- distm(x = airports[,c("V8", "V7")],  y = airports[,c("V8", "V7")])/1000
## Rename dimensions to airport codes
rownames(distance.matrix) <- airports$airports
colnames(distance.matrix) <- airports$airports
relevant_distances <- as.vector(tail(distance.matrix, n = 1))
relevant_airports_distances <- data.frame(relevant_airports_v, relevant_distances)
flights <- left_join(flights, relevant_airports_distances, by = c("arrival_airport" = "relevant_airports_v"))
rm(relevant_airports_df, relevant_airports_distances, relevant_airports_v, relevant_distances, distance.matrix)
median <- flights[["median"]]
mean <- flights[["mean"]]
distance <- flights[["relevant_distances"]]
relation <- lm(mean~distance)
plot(distance, mean, main = "Regression")
abline(relation, col = "red")
cor.test(distance, mean)
newflights <- filter(flights, median > 5)
median <- newflights[["median"]]
mean <- newflights[["mean"]]
distance <- newflights[["relevant_distances"]]
relation <- lm(median~distance)
plot(distance, median)
abline(relation, col = "red")
cor.test(distance, median)
kurz <- filter(flights, relevant_distances < 1500)
lang <- filter(flights, relevant_distances > 1500)
m <- median(flights$mean)
kurz_late <- filter(kurz, mean > m)
kurz_ok <- filter(kurz, mean< m)
lang_late <- filter(lang, mean > m)
lang_ok <- filter(lang, mean < m)
anteil_kurz_late <- count(kurz_late)/count(kurz)
anteil_lang_late <- count(lang_late)/count(lang)
anteil_kurz_ok <- count(kurz_ok)/count(kurz)
anteil_lang_ok <- count(lang_ok)/count(lang)
a <- anteil_kurz_late[1,1]
b <- anteil_kurz_ok[1,1]
c <- anteil_lang_late[1,1]
d <- anteil_lang_ok[1,1]
slices <- c(a,b)
lbls <- c("Verspätet", "Pünktlich")
pie(slices, labels = lbls, main="Kurzstreckenflüge")
slices <- c(c,d)
lbls <- c("Verspätet", "Pünktlich")
pie(slices, labels = lbls, main="Langstreckenflüge")
flights <- flights[order(flights$median), ]
############# SETUP ###############
# Libraries
library(dplyr)
library(geosphere)
library(plotrix)
# Path
setwd("/Users/tobiasleitner/Desktop/IT-Projekt/Aerodatabox_API/AerodataboxDataExtraction")
rm(list = ls())
# Variables
input <- "aerodata_flughafen_frankfurt.csv"
limit <- 20
airport <- "EDDF"
# read data
airport_raw_input <- read.csv2(input)
airports <- read.csv("https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat", header = F)
# change timestamps to utc
airport_raw_input$scheduledTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$scheduledTime)), origin="1970-01-01", tz="UTC")
airport_raw_input$actualTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$actualTime)), origin="1970-01-01", tz="UTC")
# difference between scheduled and real departure
difftime_diff <- difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime)
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
# Group by by number, arrivalAirport and count flights
airport_group <- group_by(airport_raw_input, number, arrivalAirport)
airport_group <- summarize(airport_group, count = n())
# Fiter by flight limit set above
linienfluege <- filter(airport_group, count > limit)
linienfluege <- as.vector(linienfluege[['number']])
mean_diff <- c()
median_diff <- c()
arrival_airport <- c()
quantile_75 <- c()
quantile_95 <- c()
# Filter raw input by linienflüge - only the relevant flights are left
# Calculate mean and median of difference between scheduled and actual departure time for every
for (flug in linienfluege){
process <- filter(airport_raw_input, number == flug)
mean_diff <- c(mean_diff, mean(abs(process$diff)))
median_diff <- c(median_diff, median(abs(process$diff)))
quantile_75 <- c(quantile_75, quantile(abs(process$diff), probs = 0.75))
quantile_95 <- c(quantile_95, quantile(abs(process$diff), probs = 0.95))
arrival_airport <- c(arrival_airport, head(process, n = 1)$arrivalAirport)
}
# create dataframe of linienfluege, mean, median and arrival airport
flights <- data.frame(linienfluege, mean = mean_diff, median = median_diff, quantile75 = quantile_75, quantile95 = quantile_95, arrival_airport = arrival_airport)
# delete elements
rm(flug, limit, median_diff, mean_diff, linienfluege, input, process, arrival_airport, airport_raw_input, airport_group, quantile_75, quantile_95)
# Boxplot of mean
boxplot(flights$mean)
median(flights$mean)
# sort dataframe
flights <- flights[
with(flights, order(mean)),
]
relevant_airports_v <- c(unique(flights$arrival_airport), airport)
relevant_airports_df <- data.frame(relevant_airports_v)
names(relevant_airports_df) <- "airports"
airports <- left_join(relevant_airports_df, airports, by = c("airports" = "V6"))
## Calculate matrix of differences in km
distance.matrix <- distm(x = airports[,c("V8", "V7")],  y = airports[,c("V8", "V7")])/1000
## Rename dimensions to airport codes
rownames(distance.matrix) <- airports$airports
colnames(distance.matrix) <- airports$airports
relevant_distances <- as.vector(tail(distance.matrix, n = 1))
relevant_airports_distances <- data.frame(relevant_airports_v, relevant_distances)
flights <- left_join(flights, relevant_airports_distances, by = c("arrival_airport" = "relevant_airports_v"))
rm(relevant_airports_df, relevant_airports_distances, relevant_airports_v, relevant_distances, distance.matrix)
median <- flights[["median"]]
mean <- flights[["mean"]]
distance <- flights[["relevant_distances"]]
relation <- lm(mean~distance)
plot(distance, mean, main = "Regression")
abline(relation, col = "red")
cor.test(distance, mean)
newflights <- filter(flights, median > 5)
median <- newflights[["median"]]
mean <- newflights[["mean"]]
distance <- newflights[["relevant_distances"]]
relation <- lm(median~distance)
plot(distance, median)
abline(relation, col = "red")
cor.test(distance, median)
kurz <- filter(flights, relevant_distances < 1500)
lang <- filter(flights, relevant_distances > 1500)
m <- median(flights$mean)
kurz_late <- filter(kurz, mean > m)
kurz_ok <- filter(kurz, mean< m)
lang_late <- filter(lang, mean > m)
lang_ok <- filter(lang, mean < m)
anteil_kurz_late <- count(kurz_late)/count(kurz)
anteil_lang_late <- count(lang_late)/count(lang)
anteil_kurz_ok <- count(kurz_ok)/count(kurz)
anteil_lang_ok <- count(lang_ok)/count(lang)
a <- anteil_kurz_late[1,1]
b <- anteil_kurz_ok[1,1]
c <- anteil_lang_late[1,1]
d <- anteil_lang_ok[1,1]
slices <- c(a,b)
lbls <- c("Verspätet", "Pünktlich")
pie(slices, labels = lbls, main="Kurzstreckenflüge")
slices <- c(c,d)
lbls <- c("Verspätet", "Pünktlich")
pie(slices, labels = lbls, main="Langstreckenflüge")
# Path
setwd("/Users/tobiasleitner/Desktop/IT-Projekt/Aerodatabox_API/AerodataboxDataExtraction")
rm(list = ls())
# Variables
input <- "aerodata_flughafen_frankfurt.csv"
limit <- 20
airport <- "EDDF"
# read data
airport_raw_input <- read.csv2(input)
airports <- read.csv("https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat", header = F)
# change timestamps to utc
airport_raw_input$scheduledTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$scheduledTime)), origin="1970-01-01", tz="UTC")
airport_raw_input$actualTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$actualTime)), origin="1970-01-01", tz="UTC")
# difference between scheduled and real departure
difftime_diff <- difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime)
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
View(airport_raw_input)
# difference between scheduled and real departure
difftime_diff <- abs(difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime))
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
View(airport_raw_input)
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
mean(airport_raw_input$diff)
############# SETUP ###############
# Libraries
library(dplyr)
library(geosphere)
library(plotrix)
# Path
setwd("/Users/tobiasleitner/Desktop/IT-Projekt/Aerodatabox_API/AerodataboxDataExtraction")
rm(list = ls())
# Variables
input <- "aerodata_flughafen_wien.csv"
limit <- 20
airport <- "LOWW"
# read data
airport_raw_input <- read.csv2(input)
airports <- read.csv("https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat", header = F)
# change timestamps to utc
airport_raw_input$scheduledTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$scheduledTime)), origin="1970-01-01", tz="UTC")
airport_raw_input$actualTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$actualTime)), origin="1970-01-01", tz="UTC")
# difference between scheduled and real departure
difftime_diff <- abs(difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime))
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
mean(airport_raw_input$diff)
# Group by by number, arrivalAirport and count flights
airport_group <- group_by(airport_raw_input, number, arrivalAirport)
airport_group <- summarize(airport_group, count = n())
rm(list = ls())
# Variables
input <- "aerodata_flughafen_frankfurt.csv"
limit <- 20
airport <- "EDDF"
# read data
airport_raw_input <- read.csv2(input)
airports <- read.csv("https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat", header = F)
# change timestamps to utc
airport_raw_input$scheduledTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$scheduledTime)), origin="1970-01-01", tz="UTC")
airport_raw_input$actualTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$actualTime)), origin="1970-01-01", tz="UTC")
# difference between scheduled and real departure
difftime_diff <- abs(difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime))
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
mean(airport_raw_input$diff)
# Group by by number, arrivalAirport and count flights
airport_group <- group_by(airport_raw_input, number, arrivalAirport)
airport_group <- summarize(airport_group, count = n())
# Fiter by flight limit set above
linienfluege <- filter(airport_group, count > limit)
linienfluege <- as.vector(linienfluege[['number']])
mean_diff <- c()
median_diff <- c()
arrival_airport <- c()
quantile_75 <- c()
quantile_95 <- c()
# Filter raw input by linienflüge - only the relevant flights are left
# Calculate mean and median of difference between scheduled and actual departure time for every
for (flug in linienfluege){
process <- filter(airport_raw_input, number == flug)
mean_diff <- c(mean_diff, mean(abs(process$diff)))
median_diff <- c(median_diff, median(abs(process$diff)))
quantile_75 <- c(quantile_75, quantile(abs(process$diff), probs = 0.75))
quantile_95 <- c(quantile_95, quantile(abs(process$diff), probs = 0.95))
arrival_airport <- c(arrival_airport, head(process, n = 1)$arrivalAirport)
}
# create dataframe of linienfluege, mean, median and arrival airport
flights <- data.frame(linienfluege, mean = mean_diff, median = median_diff, quantile75 = quantile_75, quantile95 = quantile_95, arrival_airport = arrival_airport)
# delete elements
rm(flug, limit, median_diff, mean_diff, linienfluege, input, process, arrival_airport, airport_raw_input, airport_group, quantile_75, quantile_95)
# Boxplot of mean
boxplot(flights$mean)
median(flights$mean)
# sort dataframe
flights <- flights[
with(flights, order(mean)),
]
relevant_airports_v <- c(unique(flights$arrival_airport), airport)
# Path
setwd("/Users/tobiasleitner/Desktop/IT-Projekt/Aerodatabox_API/AerodataboxDataExtraction")
rm(list = ls())
# Variables
input <- "aerodata_flughafen_amsterdam.csv"
limit <- 20
airport <- "EHAM"
# read data
airport_raw_input <- read.csv2(input)
airports <- read.csv("https://raw.githubusercontent.com/jpatokal/openflights/master/data/airports.dat", header = F)
# change timestamps to utc
airport_raw_input$scheduledTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$scheduledTime)), origin="1970-01-01", tz="UTC")
airport_raw_input$actualTime <- as.POSIXct(as.numeric(as.character(airport_raw_input$actualTime)), origin="1970-01-01", tz="UTC")
# difference between scheduled and real departure
difftime_diff <- abs(difftime(airport_raw_input$scheduledTime, airport_raw_input$actualTime))
airport_raw_input$diff <- as.numeric(difftime_diff, units = "mins")
# code sharing duplicate handling
airport_raw_input <- airport_raw_input %>% distinct(scheduledTime, actualTime, arrivalAirport, aircraft, diff, .keep_all = TRUE)
mean(airport_raw_input$diff)
# Group by by number, arrivalAirport and count flights
airport_group <- group_by(airport_raw_input, number, arrivalAirport)
airport_group <- summarize(airport_group, count = n())
# Fiter by flight limit set above
linienfluege <- filter(airport_group, count > limit)
linienfluege <- as.vector(linienfluege[['number']])
mean_diff <- c()
median_diff <- c()
arrival_airport <- c()
quantile_75 <- c()
quantile_95 <- c()
# Filter raw input by linienflüge - only the relevant flights are left
# Calculate mean and median of difference between scheduled and actual departure time for every
for (flug in linienfluege){
process <- filter(airport_raw_input, number == flug)
mean_diff <- c(mean_diff, mean(abs(process$diff)))
median_diff <- c(median_diff, median(abs(process$diff)))
quantile_75 <- c(quantile_75, quantile(abs(process$diff), probs = 0.75))
quantile_95 <- c(quantile_95, quantile(abs(process$diff), probs = 0.95))
arrival_airport <- c(arrival_airport, head(process, n = 1)$arrivalAirport)
}
# create dataframe of linienfluege, mean, median and arrival airport
flights <- data.frame(linienfluege, mean = mean_diff, median = median_diff, quantile75 = quantile_75, quantile95 = quantile_95, arrival_airport = arrival_airport)
# delete elements
rm(flug, limit, median_diff, mean_diff, linienfluege, input, process, arrival_airport, airport_raw_input, airport_group, quantile_75, quantile_95)
# Boxplot of mean
boxplot(flights$mean)
median(flights$mean)
# sort dataframe
flights <- flights[
with(flights, order(mean)),
]
